<?xml version="1.0" encoding="ISO-8859-1"?>
<article xmlns="http://docbook.org/ns/docbook" version="5.0">
<info>
  <title>Rivendell Notification Protocol</title>
  <author>
    <personname>
      <firstname>Fred</firstname>
      <surname>Gleason</surname>
      <email>fredg@paravelsystems.com</email>
    </personname>
  </author>
</info>

<sect1 xml:id="overview">
  <title>Overview</title>
  <para>
    This defines the IP protocol used to notify Rivendell components of
    changes to the state of database objects or other system state.
    Messages are send by means of multicast UDP packets to port 20539.
  </para>
  <para>
    The format of a message is as follows:
  </para>
  <para>
    NOTIFY <replaceable choice='req'>obj-type</replaceable>
    <replaceable choice='req'>action</replaceable>
    <replaceable choice='req'>id</replaceable>
  </para>
  <variablelist>
    <varlistentry>
      <term>
	<replaceable>obj-type</replaceable>
      </term>
      <listitem>
	<para>
	  The object type to which the message pertains.
	</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>
	<replaceable>action</replaceable>
      </term>
      <listitem>
	<para>
	  The action being reported. The following actions are defined:
	</para>
	<variablelist>
	  <varlistentry>
	    <term>
	      ADD
	    </term>
	    <listitem>
	      <para>
		The referenced object has just been added to the database.
	      </para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>
	      DELETE
	    </term>
	    <listitem>
	      <para>
		The referenced object has just been deleted from the database.
	      </para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>
	      MODIFY
	    </term>
	    <listitem>
	      <para>
		The reference object has just been modified in the database.
	      </para>
	    </listitem>
	  </varlistentry>
	</variablelist>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>
	<replaceable>id</replaceable>
      </term>
      <listitem>
	<para>
	  Unique id of the object.
	</para>
      </listitem>
    </varlistentry>
  </variablelist>
</sect1>

<sect1 xml:id="sect.object_types">
  <title>Object Types</title>
  <para>
    The following object types are defined:
  </para>
  <sect2 xml:id="sect.object_types.cart">
    <title>Carts</title>
    <para>
      <userinput>CART</userinput>
    </para>
    <table xml:id="table.object_types.carts" frame="all" pgwide="0">
      <title>Cart Fields</title>
      <tgroup cols="2" align="left" colsep="1" rowsep="1">
	<colspec colname="Field" colwidth="2.0*"/>
	<colspec colname="Value" colwidth="10.0*"/>
	<tbody>
	  <row><entry>Field</entry><entry>Value</entry></row>
	  <row><entry>obj-type</entry><entry>CART</entry></row>
	  <row><entry>id</entry><entry>Cart number</entry></row>
	  <row><entry>type</entry><entry>Unsigned Integer</entry></row>
	</tbody>
      </tgroup>
    </table>
  </sect2>

  <sect2 xml:id="sect.object_types.catch_events">
    <title>Catch Events</title>
    <para>
      <userinput>CATCH_EVENT</userinput>
    </para>
    <table xml:id="table.object_types.catch_events" frame="all" pgwide="0">
      <title>Catch Event Fields</title>
      <tgroup cols="2" align="left" colsep="1" rowsep="1">
	<colspec colname="Field" colwidth="2.0*"/>
	<colspec colname="Value" colwidth="10.0*"/>
	<tbody>
	  <row><entry>Field</entry><entry>Value</entry></row>
	  <row><entry>obj-type</entry><entry>CATCH_EVENT</entry></row>
	  <row><entry>id</entry><entry>Event ID</entry></row>
	  <row><entry>type</entry><entry>Unsigned Integer</entry></row>
	</tbody>
      </tgroup>
    </table>
  </sect2>

  <sect2 xml:id="sect.object_types.dropboxes">
    <title>Dropboxes</title>
    <para>
      <userinput>DROPBOX</userinput>
    </para>
    <table xml:id="table.object_types.dropboxes" frame="all" pgwide="0">
      <title>Log Fields</title>
      <tgroup cols="2" align="left" colsep="1" rowsep="1">
	<colspec colname="Field" colwidth="2.0*"/>
	<colspec colname="Value" colwidth="10.0*"/>
	<tbody>
	  <row><entry>Field</entry><entry>Value</entry></row>
	  <row><entry>obj-type</entry><entry>DROPBOX</entry></row>
	  <row><entry>id</entry><entry>Station hostname</entry></row>
	  <row><entry>type</entry><entry>String</entry></row>
	</tbody>
      </tgroup>
    </table>
  </sect2>

  <sect2 xml:id="sect.object_types.logs">
    <title>Logs</title>
    <para>
      <userinput>LOG</userinput>
    </para>
    <table xml:id="table.object_types.logs" frame="all" pgwide="0">
      <title>Log Fields</title>
      <tgroup cols="2" align="left" colsep="1" rowsep="1">
	<colspec colname="Field" colwidth="2.0*"/>
	<colspec colname="Value" colwidth="10.0*"/>
	<tbody>
	  <row><entry>Field</entry><entry>Value</entry></row>
	  <row><entry>obj-type</entry><entry>LOG</entry></row>
	  <row><entry>id</entry><entry>Log name</entry></row>
	  <row><entry>type</entry><entry>String</entry></row>
	</tbody>
      </tgroup>
    </table>
  </sect2>

  <sect2 xml:id="sect.object_types.pypad_instances">
    <title>PyPAD Instances</title>
    <para>
      <userinput>PYPAD</userinput>
    </para>
    <table xml:id="table.object_types.pypad" frame="all" pgwide="0">
      <title>Log Fields</title>
      <tgroup cols="2" align="left" colsep="1" rowsep="1">
	<colspec colname="Field" colwidth="2.0*"/>
	<colspec colname="Value" colwidth="10.0*"/>
	<tbody>
	  <row><entry>Field</entry><entry>Value</entry></row>
	  <row><entry>obj-type</entry><entry>PYPAD</entry></row>
	  <row><entry>id</entry><entry>ID Number</entry></row>
	  <row><entry>type</entry><entry>Unsigned Integer</entry></row>
	</tbody>
      </tgroup>
    </table>
  </sect2>

  <sect2 xml:id="sect.object_types.rss_feeds">
    <title>RSS Feeds</title>
    <para>
      <userinput>FEED</userinput>
    </para>
    <table xml:id="table.object_types.rss_feed" frame="all" pgwide="0">
      <title>RSS Feed Fields</title>
      <tgroup cols="2" align="left" colsep="1" rowsep="1">
	<colspec colname="Field" colwidth="2.0*"/>
	<colspec colname="Value" colwidth="10.0*"/>
	<tbody>
	  <row><entry>Field</entry><entry>Value</entry></row>
	  <row><entry>obj-type</entry><entry>FEED</entry></row>
	  <row><entry>id</entry><entry>Feed keyname</entry></row>
	  <row><entry>type</entry><entry>String</entry></row>
	</tbody>
      </tgroup>
    </table>
  </sect2>

  <sect2 xml:id="sect.object_types.rss_feed_items">
    <title>RSS Feed Items</title>
    <para>
      <userinput>FEED_ITEM</userinput>
    </para>
    <table xml:id="table.object_types.rss_feed_item" frame="all" pgwide="0">
      <title>RSS Feed Item Fields</title>
      <tgroup cols="2" align="left" colsep="1" rowsep="1">
	<colspec colname="Field" colwidth="2.0*"/>
	<colspec colname="Value" colwidth="10.0*"/>
	<tbody>
	  <row><entry>Field</entry><entry>Value</entry></row>
	  <row><entry>obj-type</entry><entry>FEED_ITEM</entry></row>
	  <row><entry>id</entry><entry>Podcast ID</entry></row>
	  <row><entry>type</entry><entry>Unsigned Integer</entry></row>
	</tbody>
      </tgroup>
    </table>
  </sect2>

  <sect2 xml:id="sect.object_types.station_presence">
    <title>Station Presence</title>
    <para>
      <userinput>STATION_PRESENCE</userinput>
    </para>
    <table xml:id="table.object_types.station_presence" frame="all" pgwide="0">
      <title>Station Presence Fields</title>
      <tgroup cols="2" align="left" colsep="1" rowsep="1">
	<colspec colname="Field" colwidth="2.0*"/>
	<colspec colname="Value" colwidth="10.0*"/>
	<tbody>
	  <row><entry>Field</entry><entry>Value</entry></row>
	  <row><entry>obj-type</entry><entry>STATION_PRESENCE</entry></row>
	  <row><entry>id</entry><entry>Station hostname</entry></row>
	  <row><entry>type</entry><entry>String</entry></row>
	</tbody>
      </tgroup>
    </table>
  </sect2>

</sect1>

</article>
